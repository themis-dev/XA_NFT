<template>
    <div class="market-detail">
      <section class="detail-top">
        <img v-lazy="detailData.productImage" alt="" class="work">
        <div class="work-msg">
          <div class="work-name">{{ setMarkName(detailData.name) }}</div>
          <div class="work-num">
            <div>
              <div class="item-number">
                <div class="item-number-name">限量</div>
                <div class="item-number-val">{{ detailData.num }}份</div>
              </div>
              <div class="item-number">
                <div class="item-number-name">剩余</div>
                <div class="item-number-val">{{ detailData.remainNum }}份</div>
              </div>
            </div>
            <div class="price">
              ¥ {{ detailData.price }}
            </div>
          </div>
          <div class="buy-btn" @click="handleClick">{{ detailData.price == 0 ? '立即领取' : '领取成功' }}</div>
        </div>
      </section>
      <div class="work-content container">
        <div class="work-story">
          作品故事
        </div>
        <div class="line"></div>
        <img src="../../images/img-left.png" alt="" class="img-left">
        <img src="../../images/img-right.png" alt="" class="img-right">
        <!-- <div class="work-msg-item" v-for="item in data" v-bind:key="item.title">
          <div class="work-msg-item-title">{{item.title}}</div>
          <div class="work-msg-item-val">{{item.content}}</div>
        </div> -->
        <div class="work-msg-item">
          <div class="work-msg-item-title">作品介绍</div>
          <div class="work-msg-item-val">{{detailData.productIntroduction}}</div>
        </div>
        <div class="work-msg-item">
          <div class="work-msg-item-title">作品细节</div>
          <div class="work-msg-item-val">{{detailData.productDetail}}</div>
        </div>
        <div class="work-msg-item">
          <div class="work-msg-item-title">作者介绍</div>
          <div class="work-msg-item-val">{{detailData.creatorIntroduction}}</div>
        </div>
        <div class="work-msg-item">
          <div class="work-msg-item-title">发行方</div>
          <div class="work-msg-item-val">{{detailData.publisher}}</div>
        </div>
        <div class="work-msg-item">
          <div class="work-msg-item-title">收藏价值</div>
          <div class="work-msg-item-val">{{detailData.numismaticValue}}</div>
        </div>
        <div class="work-msg-item">
          <div class="work-msg-item-title">创作背景</div>
          <div class="work-msg-item-val">{{detailData.creationBackground}}</div>
        </div>
        <div class="work-msg-author">
          <div class="work-msg-author-item">
            <span class="author-item1">创作者</span>
            <span class="author-item2">{{ detailData.creator }}</span>
          </div>
          <div class="work-msg-author-item">
            <span class="author-item1">发行方</span>
            <span class="author-item2">{{ detailData.publisher }}</span>
          </div>
        </div>
        <div class="purchase-notes">
          <div class="purchase-notes-title">
            购买须知
          </div>
          <div class="purchase-notes-content">
            数字藏品为虚拟数字商品，而非实物，仅限实名认证为年满14周岁的中国大陆用户购买。数字藏品的版权由发行方或原创者拥有，除另行取得版权拥有者书面同意外，用户不得将数字藏品用于任何商业用途。本商品一经售出，不支持退换。本商品源文件不支持本地下载。请勿对数字藏品进行炒作、场外交易、欺诈，或以任何其他非法方式进行使用。
          </div>
        </div>
        <div class="work-msg-footer">
          <img src="../../images/detail-img2.png" alt="">
          <div class="work-msg-footer-title">雄安链提供支持</div>
        </div>
      </div>
    </div>
</template>

<script>
import { getMarketDetail, marketPayment } from '@/api/market.js'
  export default {
    name: 'collection',
    components: {
    },
    data() {
      return {
        pid: this.$route.query.pid,
        data: [
          {
            title: '作品介绍',
            content: '雄安五周年纪念品，以白洋淀生态和未来科技创新为思维点，创作了10件代表雄安新区特色的数字艺术作品，分别由10位不同领域的数字艺术家创作而成。内容丰富，类型多样，书法、绘画、影视、数字手办、音乐以及动画等等'
          },
          {
            title: '作品细节',
            content: '数字藏品是使用蚂蚁链的区块链技术进行唯一标识的经数字化的特定作品、艺术品和商品，包括但不限于数字画作、图片、音乐、视频、3D模型等各种形式。数字藏品为虚拟数字商品，而非实物，一经售出，不支持退换。'
          },
          {
            title: '作者介绍',
            content: '每个数字藏品都映射着特定区块链上的唯一序列号，不可篡改、不可分割，也不能互相替代。每一个数字藏品都代表特定作品、艺术品和商品或其限量发售的单个数字复制品，记录着其不可篡改的链上权利。'
          },
          {
            title: '发行方',
            content: '雄安五周年纪念品，以白洋淀生态和未来科技创新为思维点，创作了10件代表雄安新区特色的数字艺术作品，分别由10位不同领域的数字艺术家创作而成。内容丰富，类型多样，书法、绘画、影视、数字手办、音乐以及动画等等'
          },
          {
            title: '收藏价值',
            content: '数字藏品是使用蚂蚁链的区块链技术进行唯一标识的经数字化的特定作品、艺术品和商品，包括但不限于数字画作、图片、音乐、视频、3D模型等各种形式。数字藏品为虚拟数字商品，而非实物，一经售出，不支持退换。每个数字藏品都映射着特定区块链上的唯一序列号，不可篡改、不可分割，也不能互相替代。每一个数字藏品都代表特定作品、艺术品和商品或其限量发售的单个数字复制品，记录着其不可篡改的链上权利。因此数字藏品与虚拟货币等同质化代币存在本质不同，有特定作品、艺术品和商品的实际价值做支撑，也不具备支付功能等任何货币属性。'
          },
          {
            title: '创作背景',
            content: '作为数字藏品的收藏家，你拥有每个数字藏品背后对应的特定作品、艺术品和商品的单个数字复制品，不仅可以观赏藏品、享受收藏的美好体验，还可以与好友分享收藏见解和快乐。'
          },
        ],
        detailData: {}

      }
    },
    computed: {
      message() {
        return ''
      }
    },
    created() {
    },
    mounted() {
      this.getData()
    },
    methods: {
      goDetail() {
        this.$router.push({path:'/mine/order-detail'});
      },
      getData() {
        getMarketDetail({pid: this.pid}).then(res => {
          if(res.status == 1 && res.data) {
            this.detailData = res.data
          } 
        }).catch(error => {
          console.log(error)
        })
      },
      handleClick() {
        if(this.detailData.status == 0) {
          this.$message({
            message: '当前商品已售罄',
            type: 'warning'
          })
          return
        } else if(this.detailData.status == 9){
          this.$message({
            message: '当前商品未开售',
            type: 'warning'
          })
          return
        }
        marketPayment(this.pid).then(res => {
          console.log(res)
          if(res.status == 1) {
            this.$message({
              message: res.message,
              type: 'success'
            })
            this.$router.push({
              path: '/mine/order',
              query: {
                active: 9
              }
            })
          } else if(res.status == -1) {
            this.$message({
              message: res.message,
              type: 'warning'
            })
          }
        }).catch(error => {
          console.log(error)
          if(error.response.data.status == -9) {
            this.$message({
              message: error.response.data.message,
              type: 'error'
            })
            this.$router.push({
              path: '/user/login'
            })
          }
        })
      },
      setMarkName(name) {
        return name.substring(0, 8)
      }
    }
  }
</script>

<style rel="stylesheet/scss" lang="scss" scoped>
 @media (min-width: 991.98px) {
.market-detail {
  margin-bottom: -4rem;
  background-color: #fff;
  .detail-top {
    background-color: #233370;
    background-image: url(../../images/market-banner.png);
    background-repeat: no-repeat;
    width: 100%;
    height: 670px;
    display: flex;
    flex-direction: column;
    align-items: center;
    .work {
      width: 336px;
      height: 336px;
      margin-top: 76px;
      border-radius: 8px;
    }
    .work[lazy=loading] {
      width: 336px;
      height: 336px;
      background: url('../../images/loading-bg.png') no-repeat;
      background-size: cover;
    }
    .work-msg {
      background-image: url(../../images/detail-img1.png);
      background-repeat: no-repeat;
      width: 649px;
      height: 144px;
      margin-top: 34px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: start;
      position: relative;
      .work-name {
        font-size: 28px;
        font-family: MiSans Semibold;
        font-weight: 600;
        line-height: 37px;
        color: #FFFFFF;
      }
      .work-num {
        display: flex;
        align-items: center;
        justify-content: start;
        margin-top: 10px;
      }
      .item-number {
          padding-left: 11px;
          margin-top: 4px;
          height: 18px;
          color: #515152;
          display: flex;
          align-items: center;
          .item-number-name {
            width: 29px;
            height: 18px;
            background: #EEE1C5;
            font-size: 12px;
            font-family: MiSans Semibold;
            font-weight: 400;
            line-height: 18px;
            color: #515152;
            text-align: center;
          }
          .item-number-val {
            width: 56px;
            height: 18px;
            background: #646464;
            font-size: 12px;
            font-family: MiSans Semibold;
            font-weight: 400;
            line-height: 18px;
            color: #F1E1BE;
            text-align: center;
          }
      }
      .price {
        font-size: 30px;
        font-family: MiSans Semibold;
        font-weight: 600;
        line-height: 39px;
        color: #CFA980;
        letter-spacing: 1.3px;
        padding-left: 30px;
      }
      .buy-btn {
        width: 215px;
        height: 52px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(152deg, #EDD9BB 0%, #BE905D 100%);
        box-shadow: 0px 3px 6px rgba(200, 159, 113, 0.47);
        opacity: 1;
        border-radius: 26px;
        font-size: 20px;
        font-family: MiSans Semibold;
        font-weight: 600;
        color: #FFFFFF;
        text-shadow: 0px 3px 6px rgba(0, 0, 0, 0.38);
        cursor: pointer;
        position: absolute;
        bottom: -20px;
      }
    }
  }
  .work-content {
    background-color: #fff;
    margin-top: 59px;
    padding: 0 40px;
    position: relative;
    .work-story {
      font-size: 22px;
      font-family: MiSans Semibold;
      font-weight: 600;
      line-height: 29px;
      color: #333333;
    }
    .line {
      width: 100%;
      height: 1px;
      background-color:#E5E5E5;
      margin-top: 17px;
      margin-bottom: 44px;
    }
    .img-left {
      width: 129px;
      height: 158px;
      position: absolute;
      left: -200px;
      top: 300px;
    }
    .img-right {
      width: 140px;
      height: 161px;
      position: absolute;
      right: -200px;
      top: 300px;
    }
    .work-msg-item {
      padding-left: 73px;
      padding-right: 66px;
      .work-msg-item-title {
        font-size: 18px;
        font-family: MiSans Semibold Semibold;
        font-weight: 600;
        line-height: 24px;
        color: #666666;
        margin-bottom: 15px;
      }
      .work-msg-item-val {
        font-size: 14px;
        font-family: MiSans Semibold;
        font-weight: 400;
        line-height: 19px;
        color: #848484;
        margin-bottom: 25px;
      }
    }
    .work-msg-author {
      width: 100%;
      height: 66px;
      background: rgba(244, 244, 255, 1);
      border-radius: 10px;
      margin-top: 44px;
      display: flex;
      justify-content: space-between;
      padding-left: 85px;
      padding-right: 228px;
      .work-msg-author-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        .author-item1 {
          font-size: 18px;
          font-family: MiSans Semibold;
          font-weight: 400;
          line-height: 24px;
          color: #666666;
        }
        .author-item2 {
          font-size: 18px;
          font-family: MiSans Semibold Semibold;
          font-weight: 600;
          line-height: 24px;
          color: #666666;
          padding-left: 30px;
        }
      }
    }
    .purchase-notes {
      margin-top: 54px;
      text-align: center;
      .purchase-notes-title {
        font-size: 16px;
        font-family: MiSans Semibold Semibold;
        font-weight: 600;
        line-height: 22px;
        color: #777777;
      }
      .purchase-notes-content {
        font-size: 12px;
        font-family: MiSans Semibold;
        font-weight: 400;
        line-height: 18px;
        color: #B5B5B5;
        margin-top: 12px;
        // padding: 0 260px;
        text-align: left;
      }
    }
    .work-msg-footer {
      margin-top: 31px;
      text-align: center;
      img {
        width: 27px;
        height: 41px;
      }
      .work-msg-footer-title {
        font-size: 16px;
        font-family: MiSans Semibold;
        font-weight: 400;
        line-height: 22px;
        color: #747474;
        margin-top: 6px;
      }
    }
  }
}
}
@media (max-width: 500px) {
  .container{
    padding: 0;
  }
.market-detail{
  width: 100%;
  background-color: #fff;
  .detail-top {
    background-color: #233370;
    background-image: url(../../images/market-banner.png);
    background-repeat: no-repeat;
    width: 100%;
    height: 670px;
    display: flex;
    flex-direction: column;
    align-items: center;
    .work {
      width: 18.69rem;
      height: 18.69rem;
      margin-top: 76px;
      border-radius: 8px;
    }
    .work[lazy=loading] {
      width: 18.69rem;
      height: 18.69rem;
      background: url('../../images/loading-bg.png') no-repeat;
      background-size: cover;
    }
    .work-msg {
        background-image: url(../../images/detail-img1.png);
        background-repeat: no-repeat;
        background-size: 100% 100%;
        width: 21rem;
        height: 142px;
        margin-top: 34px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: start;
        position: relative;
        .work-name {
          font-size: 28px;
          font-family: MiSans Semibold;
          font-weight: 600;
          line-height: 37px;
          color: #FFFFFF;
        }
        .work-num {
          display: flex;
          align-items: center;
          justify-content: start;
          margin-top: 10px;
        }
        .item-number {
          padding-left: 11px;
          margin-top: 4px;
          height: 18px;
          color: #515152;
          display: flex;
          align-items: center;
          .item-number-name {
            width: 29px;
            height: 18px;
            background: #EEE1C5;
            font-size: 12px;
            font-family: MiSans Semibold;
            font-weight: 400;
            line-height: 18px;
            color: #515152;
            text-align: center;
          }
          .item-number-val {
                width: 56px;
                height: 18px;
                background: #646464;
                font-size: 12px;
                font-family: MiSans Semibold;
                font-weight: 400;
                line-height: 18px;
                color: #F1E1BE;
                text-align: center;
              }
          }
          .price {
            font-size: 30px;
            font-family: MiSans Semibold;
            font-weight: 600;
            line-height: 39px;
            color: #CFA980;
            letter-spacing: 1.3px;
            padding-left: 30px;
          }
          .buy-btn {
            width: 215px;
            height: 52px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(152deg, #EDD9BB 0%, #BE905D 100%);
            box-shadow: 0px 3px 6px rgba(200, 159, 113, 0.47);
            opacity: 1;
            border-radius: 26px;
            font-size: 20px;
            font-family: MiSans Semibold;
            font-weight: 600;
            color: #FFFFFF;
            text-shadow: 0px 3px 6px rgba(0, 0, 0, 0.38);
            cursor: pointer;
            position: absolute;
            bottom: -20px;
        }
    }
  }
  .work-content {
    background-color: #fff;
    margin-top: 59px;
    position: relative;
    .work-story {
      font-size: 22px;
      font-family: MiSans Semibold;
      font-weight: 600;
      line-height: 29px;
      color: #333333;
      padding: 0 24px;
    }
    .line {
      width: 100%;
      height: 1px;
      background-color:#E5E5E5;
      margin-top: 17px;
      margin-bottom: 44px;
    }
    .img-left {
      display: none;
    }
    .img-right {
      display: none;
    }
    .work-msg-item {
      padding: 0 24px;
      .work-msg-item-title {
        font-size: 18px;
        font-family: MiSans Semibold Semibold;
        font-weight: 600;
        line-height: 24px;
        color: #666666;
        margin-bottom: 15px;
      }
      .work-msg-item-val {
        font-size: 14px;
        font-family: MiSans Semibold;
        font-weight: 400;
        line-height: 19px;
        color: #848484;
        margin-bottom: 25px;
      }
    }
    .work-msg-author {
      width: 100%;
      height: 105px;
      background: rgba(244, 244, 255, 1);
      border-radius: 10px;
      margin-top: 44px;
      display: flex;
      flex-direction: column;
      padding: 0 24px;
      align-items: center;
      justify-content: center;
      .work-msg-author-item {
        width: 100%;
        display: flex;
        align-items: center;
        .author-item1 {
          font-size: 18px;
          font-family: MiSans Semibold;
          font-weight: 400;
          line-height: 34px;
          color: #666666;
        }
        .author-item2 {
          font-size: 18px;
          font-family: MiSans Semibold Semibold;
          font-weight: 600;
          line-height: 34px;
          color: #666666;
          padding-left: 30px;
        }
      }
    }
    .purchase-notes {
      padding: 0px 20px;
      margin-top: 54px;
      text-align: center;
      .purchase-notes-title {
        font-size: 16px;
        font-family: MiSans Semibold Semibold;
        font-weight: 600;
        line-height: 22px;
        color: #777777;
      }
      .purchase-notes-content {
        font-size: 12px;
        font-family: MiSans Semibold;
        font-weight: 400;
        line-height: 18px;
        color: #B5B5B5;
        margin-top: 12px;
        // padding: 0 260px;
        text-align: left;
      }
    }
    .work-msg-footer {
      margin-top: 31px;
      text-align: center;
      img {
        width: 27px;
        height: 41px;
      }
      .work-msg-footer-title {
        font-size: 16px;
        font-family: MiSans Semibold;
        font-weight: 400;
        line-height: 22px;
        color: #747474;
        margin-top: 6px;
      }
    }
  }
}
}
</style>
